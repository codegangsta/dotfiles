#!/usr/bin/env zsh

tmux_dir=$DOTFILES/tmux
config_file=$tmux_dir/$1
session_name=$1

# check for args
if [ -z $1 ]; then
  ls $tmux_dir
  return
fi

# check for config file
if [ ! -e $config_file ]; then
  print "File $config_file does not exist" >&2
  return 1
fi

if ! tmux has-session -t $session_name; then
  if [ ! -z $TMUX ]; then
    print "Cannot execute inside a tmux session. tmux detach first to run this command"
    return 1
  fi
  # load config for new sessions
  tmux start \; source-file $config_file
elif [ -z $TMUX ]; then
  # attach to existing session
  tmux attach -t $session_name
else
  # switch to session if we are inside another session
  tmux switch-client -t $session_name
fi


