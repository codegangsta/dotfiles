# LazyBeads custom commands
# Set LAZYBEADS_CONFIG="$HOME/.dotfiles/lazybeads.yml" in your shell config

customCommands:
  # Tmux-based AI workflow commands
  - key: "P"
    description: "Plan: flesh out issue requirements"
    context: "list"
    command: >-
      if tmux list-windows -F '#{window_name}' | grep -q '^{{.ID}}$'; then
        tmux select-window -t '{{.ID}}';
      else
        tmux new-window -dn '{{.ID}}' "claude --dangerously-skip-permissions '/codegangsta:plan {{.ID}}'";
      fi

  - key: "B"
    description: "Build: implement the issue"
    context: "list"
    command: >-
      if tmux list-windows -F '#{window_name}' | grep -q '^{{.ID}}$'; then
        tmux select-window -t '{{.ID}}';
      else
        tmux new-window -dn '{{.ID}}' "claude --dangerously-skip-permissions '/codegangsta:build {{.ID}}'";
      fi

  - key: "G"
    description: "Go to tmux window for issue"
    context: "list"
    command: >-
      if tmux list-windows -F '#{window_name}' | grep -q '^{{.ID}}$'; then
        tmux select-window -t '{{.ID}}';
      else
        echo "No tmux window for {{.ID}}. Press P to plan or B to build.";
        read -n 1;
      fi

  # AI-powered commands (tmux + claude)
  - key: "C"
    description: "Claude agent on issue"
    context: "list"
    command: >-
      tmux new-window -dn '{{.ID}}' "claude --dangerously-skip-permissions 'Work on beads issue {{.ID}}. Use bd show {{.ID}} to read the details.'"

  - key: "R"
    description: "AI review issue"
    context: "detail"
    command: >-
      tmux new-window -dn '{{.ID}}' "claude --dangerously-skip-permissions 'Review beads issue {{.ID}} for completeness and clarity. Use bd show {{.ID}} to read it, then suggest improvements.'"

  # File editing (nvim pane integration)
  - key: "E"
    description: "Edit in nvim pane"
    context: "detail"
    command: >-
      nvim_pane=$(tmux list-panes -F '#{pane_id}:#{pane_current_command}' | grep -iE ':n?vim' | head -1 | cut -d: -f1);
      if [ -n "$nvim_pane" ]; then
        tmux send-keys -t "$nvim_pane" Escape ":e {{.FilePath}}" Enter;
        tmux select-pane -t "$nvim_pane";
      else
        tmux split-window -v "nvim '{{.FilePath}}'";
      fi
